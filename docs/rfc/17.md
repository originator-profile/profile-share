# Certificate Metadata Schema - Editor's Draft

## 概要

本文書では Originator Profile 技術研究組合の開発するアプリケーションで使用される証明書のデータ構造を説明します。

## 範囲

- 本文書は Originator Profile 技術研究組合の開発するアプリケーションで使用される証明書のデータ構造の参考情報です。
- 認証制度、証明書の要件、組織の確認プロセスは本文書の範囲外です。

## 用語

本文書に説明のない用語については、用語 RFC 文書を参照してください。

- [SD-JWT VC Type Metadata](https://www.ietf.org/archive/id/draft-ietf-oauth-sd-jwt-vc-04.html#name-type-metadata)
- Certificate

## Certificate Metadata の形式

必ず Certificate でなければなりません (MUST)。

### クレーム

#### `vct`

必ず `https://originator-profile.org/certificate` でなければなりません (MUST)。

#### `sub`

REQUIRED. 証明書の対象となる Originator Profile ID です。

#### `iat`

OPTIONAL. 証明書の発行日時の UNIX 時間 (秒単位) です。

#### `exp`

OPTIONAL. 証明書の期限切れ日時の UNIX 時間 (秒単位) です。
検証者は現在日時が exp の日時に達するか超えているならば、必ずこの SD-JWT の検証処理を拒否しなければなりません (MUST)。

#### `first_issued_at`

OPTIONAL. 証明書の初回発行日時の UNIX 時間 (秒単位) です。

#### `certification_system_id`

REQUIRED. 認証制度のグローバルに一意な識別子です。

#### `certifier`

REQUIRED. Certificate の発行者または認証制度を運用する組織です。

#### `verifier`

OPTIONAL. 証明書を検証した第三者組織です。

第三者認証などで証明書を発行する組織とその証明書の内容が適正である事を確認する組織が異なる場合、その確認した組織を `verifier` クレームで表せます。

#### `category`

REQUIRED. 証明書が属するカテゴリーです。

カテゴリーの値は Certificate Category RFC 文書を参照してください。

:::note

以下の課題があり、検討中です。

- カテゴリーのデータ構造
- 複数のカテゴリーに属していることを表現可能とするか

:::

### サブスキーマ

#### `organization`

組織情報を表す JSON Object です。

## SD-JWT VC Type Metadata

_本セクションは参考情報です。_

SD-JWT VC Type Metadata の具体例を次に示します。

```json
{
  "vct": "https://originator-profile.org/certificate",
  "title": "Certificate Metadata",
  "schema": {
    "$schema": "https://json-schema.org/draft/2019-09/schema",
    "title": "Certificate Metadata",
    "type": "object",
    "additionalProperties": true,
    "$defs": {
      "organizationJP": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "domain_name": {
            "title": "ドメイン名 (RFC 4501)",
            "type": "string"
          },
          "url": {
            "title": "ウェブサイトのURL",
            "type": "string"
          },
          "logo": {
            "title": "ロゴ画像URL",
            "type": "string"
          },
          "logo#integrity": {
            "title": "Integrity Metadata",
            "description": "https://www.w3.org/TR/SRI/#framework",
            "type": "string"
          },
          "country": {
            "title": "国",
            "type": "string",
            "description": "ISO 3166-1 alpha-2",
            "enum": ["JP"]
          },
          "name": {
            "title": "法人名",
            "type": "string"
          },
          "description": {
            "title": "説明",
            "type": "string"
          },
          "corporate_number": {
            "title": "法人番号",
            "type": "string"
          },
          "email": {
            "title": "メールアドレス",
            "type": "string"
          },
          "phone_number": {
            "title": "電話番号",
            "type": "string"
          },
          "postal_code": {
            "title": "郵便番号",
            "type": "string"
          },
          "region": {
            "title": "都道府県",
            "type": "string"
          },
          "locality": {
            "title": "市区町村",
            "type": "string"
          },
          "street_address": {
            "title": "丁目番地など",
            "type": "string"
          },
          "contact_title": {
            "title": "連絡先表示名",
            "type": "string"
          },
          "contact_url": {
            "title": "連絡先URL",
            "type": "string"
          },
          "privacy_policy_title": {
            "title": "プライバシーポリシー表示名",
            "type": "string"
          },
          "privacy_policy_url": {
            "title": "プライバシーポリシーURL",
            "type": "string"
          },
          "publishing_principle_title": {
            "title": "編集ガイドライン表示名",
            "type": "string"
          },
          "publishing_principle_url": {
            "title": "編集ガイドラインURL",
            "type": "string"
          }
        },
        "required": [
          "domain_name",
          "url",
          "country",
          "name",
          "corporate_number"
        ]
      },
      "organization": {
        "oneOf": [{ "$ref": "#/$defs/organizationJP" }]
      }
    },
    "properties": {
      "certification_system_id": {
        "title": "認定制度ID",
        "type": "string"
      },
      "first_issued_at": {
        "title": "証明書の初回発行日時",
        "type": "number"
      },
      "locale": {
        "title": "ロケール",
        "description": "Unicode CLDR locale identifier",
        "type": "string"
      },
      "name": {
        "title": "認証制度名",
        "type": "string"
      },
      "description": {
        "title": "認証制度の説明",
        "type": "string"
      },
      "ref": {
        "title": "認証制度の詳細URL",
        "type": "string"
      },
      "image": {
        "title": "画像URL",
        "type": "string"
      },
      "image#integrity": {
        "title": "Integrity Metadata",
        "description": "https://www.w3.org/TR/SRI/#framework",
        "type": "string"
      },
      "certifier": {
        "$ref": "#/$defs/organization"
      },
      "verifier": {
        "$ref": "#/$defs/organization"
      },
      "category": {
        "type": "string"
      }
    }
    },
    "required": [
      "certification_system_id",
      "locale",
      "name",
      "description",
      "ref",
      "certifier",
      "category"
    ]
  }
}
```

Certificate Metadata のクレームの具体例を次に示します。

```json
{
  "vct": "https://originator-profile.org/certificate",
  "vct#integrity": "sha256-yYu9mVg5URjeq3jfVl2e6SAkVVdJYbJihKlP/0bYmEg=",
  "iss": "https://example.org/",
  "iss#integrity": "sha256-yYu9mVg5URjeq3jfVl2e6SAkVVdJYbJihKlP/0bYmEg=",
  "sub": "example.jp",
  "first_issued_at": 1620294800,
  "iat": 1680274800,
  "exp": 1743433200,
  "locale": "ja-JP",
  "name": "○○認証 (※開発用サンプル)",
  "description": "これは○○認証の開発用サンプルです。",
  "ref": "https://example.or.jp/about",
  "image": "https://example.or.jp/credential/image.svg",
  "image#integrity": "sha256-aA2O5YTvhXCYA9ci7rtJ/zJIpsbAyOhy3YXeQEYGZV8=",
  "certification_system_id": "5374a35f-57ce-43fd-84c3-2c9b0163e3df",
  "certifier": {
    "domain_name": "example.or.jp",
    "url": "https://example.or.jp/",
    "country": "JP",
    "name": "○○協会 (※開発用サンプル)",
    "logo": "https://example.or.jp/image/icon.svg",
    "logo#integrity": "sha256-aA2O5YTvhXCYA9ci7rtJ/zJIpsbAyOhy3YXeQEYGZV8=",
    "corporate_number": "0000000000000",
    "postal_code": "000-0000",
    "region": "東京都",
    "locality": "千代田区",
    "street_address": "○○○",
    "contact_title": "お問い合わせ",
    "contact_url": "https://example.or.jp/contact",
    "privacy_policy_title": "プライバシーポリシー",
    "privacy_policy_url": "https://example.or.jp/privacy"
  },
  "verifier": {
    "domain_name": "example.or.jp",
    "url": "https://example.or.jp/",
    "country": "JP",
    "name": "○○協会 (※開発用サンプル)",
    "logo": "https://example.or.jp/image/icon.svg",
    "logo#integrity": "sha256-aA2O5YTvhXCYA9ci7rtJ/zJIpsbAyOhy3YXeQEYGZV8=",
    "corporate_number": "0000000000000",
    "postal_code": "000-0000",
    "region": "東京都",
    "locality": "千代田区",
    "street_address": "○○○",
    "contact_title": "お問い合わせ",
    "contact_url": "https://example.or.jp/contact",
    "privacy_policy_title": "プライバシーポリシー",
    "privacy_policy_url": "https://example.or.jp/privacy"
  },
  "category": "業界団体による認証"
}
```
