resourceServers:
  - name: レジストリ API (Created by CLI)
    identifier: @@REGISTRY_API_URL@@
    allow_offline_access: false
    enforce_policies: true
    scopes:
      - value: write:requests
        description: 申請を作成・更新できる
      - value: write:reviews
        description: 審査が作成・更新できる
      - value: issue:ops
        description: OP発行ができる
      - value: write:users
        description: ユーザーアカウントの登録・アクチベーションができる
    signing_alg: RS256
    skip_consent_for_verifiable_first_party_clients: true
    token_dialect: access_token_authz
    token_lifetime: 86400
    token_lifetime_for_web: 7200
clients:
  - name: Post Login Actions Management API Client (Created by CLI)
    app_type: non_interactive
    cross_origin_auth: false
    custom_login_page_on: true
    grant_types:
      - client_credentials
    is_first_party: true
    is_token_endpoint_ip_header_trusted: false
    jwt_configuration:
      alg: RS256
      lifetime_in_seconds: 36000
      secret_encoded: false
    oidc_conformant: true
    refresh_token:
      expiration_type: non-expiring
      leeway: 0
      infinite_token_lifetime: true
      infinite_idle_token_lifetime: true
      token_lifetime: 31557600
      idle_token_lifetime: 2592000
      rotation_type: non-rotating
    sso_disabled: false
    token_endpoint_auth_method: client_secret_post
  - name: OP登録サイト UI (Created by CLI)
    allowed_clients: []
    allowed_logout_urls: @@ALLOWED_LOGOUT_URLS@@
    allowed_origins: @@ALLOWED_ORIGINS@@
    app_type: spa
    callbacks: @@CALLBACKS@@
    client_aliases: []
    cross_origin_auth: false
    custom_login_page_on: true
    grant_types:
      - authorization_code
      - implicit
      - refresh_token
    is_first_party: true
    is_token_endpoint_ip_header_trusted: false
    jwt_configuration:
      alg: RS256
      lifetime_in_seconds: 36000
      secret_encoded: false
    native_social_login:
      apple:
        enabled: false
      facebook:
        enabled: false
    oidc_conformant: true
    refresh_token:
      expiration_type: expiring
      leeway: 0
      token_lifetime: 2592000
      idle_token_lifetime: 1296000
      infinite_token_lifetime: false
      infinite_idle_token_lifetime: false
      rotation_type: rotating
    sso_disabled: false
    token_endpoint_auth_method: none
    web_origins: @@WEB_ORIGINS@@
  - name: OP登録サイト (試験運用版) (Created by CLI)
    allowed_clients: []
    allowed_logout_urls:
      - https://oprdev.originator-profile.org/app/
      - https://oprdev.originator-profile.org/
    app_type: spa
    callbacks:
      - https://oprdev.originator-profile.org/app/
    client_aliases: []
    cross_origin_auth: false
    cross_origin_authentication: false
    custom_login_page_on: true
    grant_types:
      - authorization_code
      - implicit
      - refresh_token
    is_first_party: true
    is_token_endpoint_ip_header_trusted: false
    jwt_configuration:
      alg: RS256
      lifetime_in_seconds: 36000
      secret_encoded: false
    native_social_login:
      apple:
        enabled: false
      facebook:
        enabled: false
    oidc_conformant: true
    refresh_token:
      expiration_type: expiring
      leeway: 0
      token_lifetime: 2592000
      idle_token_lifetime: 1296000
      infinite_token_lifetime: false
      infinite_idle_token_lifetime: false
      rotation_type: rotating
    sso_disabled: false
    token_endpoint_auth_method: none
    web_origins: []
clientGrants:
  - client_id: Post Login Actions Management API Client (Created by CLI)
    audience: '##AUTH0_MANAGEMENT_API_IDENTIFIER##'
    scope:
      - update:users
      - read:stats
roles:
  - name: admin (Created by CLI)
    description: 管理者
    permissions:
      - permission_name: write:users
        resource_server_identifier: @@REGISTRY_API_URL@@
  - name: certifier (Created by CLI)
    description: 認証機関
    permissions:
      - permission_name: issue:ops
        resource_server_identifier: @@REGISTRY_API_URL@@
      - permission_name: write:reviews
        resource_server_identifier: @@REGISTRY_API_URL@@
  - name: group (Created by CLI)
    description: 組織
    permissions:
      - permission_name: write:requests
        resource_server_identifier: @@REGISTRY_API_URL@@
actions:
  - name: add default role to new user (Created by CLI)
    code: ./actions/add-default-role-to-new-user.js
    dependencies:
      - name: auth0
        version: 4.0.1
    deployed: true
    runtime: node18-actions
    secrets:
      - name: DOMAIN
        value: @@AUTH0_ACTION_DOMAIN@@
      - name: CLIENT_ID
        value: @@AUTH0_ACTION_CLIENT_ID@@
      - name: CLIENT_SECRET
        value: @@AUTH0_ACTION_CLIENT_SECRET@@
      - name: GROUP_ROLE_ID
        value: @@GROUP_ROLE_ID@@
    status: built
    supported_triggers:
      - id: post-login
        version: v3
triggers:
  post-login:
    - action_name: add default role to new user (Created by CLI)
      display_name: add default role to new user (Created by CLI)
tenant:
  enabled_locales:
    - ja
  flags:
    revoke_refresh_token_grant: false
    disable_clickjack_protection_headers: false
  sandbox_version: '18'
emailProvider:
  name: sendgrid
  credentials:
    api_key: '##SENDGRID_API_KEY##'
  default_from_address: '##DEFAULT_FROM_ADDRESS##'
  enabled: true
connections:
  - name: google-oauth2
    strategy: google-oauth2
    is_domain_connection: false
    options:
      email: true
      scope:
        - email
        - profile
      profile: true
# databases:
#   - name: Username-Password-Authentication
#     strategy: auth0
#     is_domain_connection: false
#     options:
#       mfa:
#         active: true
#         return_enroll_settings: true
#       import_mode: false
#       customScripts:
#         change_password: ./databases/Username-Password-Authentication/change_password.js
#         create: ./databases/Username-Password-Authentication/create.js
#         delete: ./databases/Username-Password-Authentication/delete.js
#         get_user: ./databases/Username-Password-Authentication/get_user.js
#         login: ./databases/Username-Password-Authentication/login.js
#         verify: ./databases/Username-Password-Authentication/verify.js
#       passwordPolicy: good
#       password_history:
#         size: 5
#         enable: false
#       strategy_version: 2
#       requires_username: false
#       password_dictionary:
#         enable: false
#         dictionary: []
#       brute_force_protection: true
#       password_no_personal_info:
#         enable: false
#       password_complexity_options:
#         min_length: 8
#       enabledDatabaseCustomization: false
#     realms:
#       - Username-Password-Authentication
